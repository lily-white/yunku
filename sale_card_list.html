<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="apple-touch-fullscreen" content="YES">
    <META HTTP-EQUIV="imagetoolbar" CONTENT="no" />
    <meta name="format-detection" content="telephone=no,email=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="pragram" content="no-cache">
    <title>云库</title>
    <link rel="stylesheet" type="text/css" href="css/sm.css" />
    <link rel="stylesheet" type="text/css" href="css/common.css" />
</head>

<body>
    <div class="page-group scl">
        <div class="page page-current">
            <header class="bar bar-nav">
                <a class="icon pull-left">&lt;</a>
                <h1 class="title">保养卡销售单</h1>
            </header>
            <div>
                <div class="buttons-tab">
                    <a href="#" class="tab-link active button external">全部</a>
                    <a href="#" class="tab-link button external">待付款</a>
                    <a href="#" class="tab-link button external">已付款</a>
                </div>
                <form action="" id="searchForm">
                <div class="action-block">
                    <label class="label-checkbox item-content tab-item" id="all-check">
                        <input type="checkbox" name="my-radio" />
                        <div class="item-media"><i class="icon icon-form-checkbox"></i><span class="checkbox-label">全选</span></div>
                    </label>
                    <div class="search-block"><input type="text" class="search-txt" placeholder="车牌、姓名、手机"></div>
                    <span class="button pay-batch-btn">批量付款</span>
                </div>
                </form>
                <div class="content infinite-scroll" data-distance="-20">
                    <div class="sale-list">
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status unpay">
                                <div class="item-price"><span class="unit">￥</span><span class="price">98.00</span></div>
                                <div class="button pay-btn">付款</div>
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                        <div class="sale-item">
                            <label class="label-checkbox item-content tab-item">
                                <input type="checkbox" name="my-radio" />
                                <div class="item-media">
                                    <i class="icon icon-form-checkbox"></i>    
                                </div>
                                <div class="sale-content">
                                    <div class="sale-info">
                                        <span class="plate-no">浙A123456</span>
                                        <span class="card-no">LJDLAA295C0156551</span>
                                    </div>
                                    <div class="sale-contact">
                                      13941922300 赵某飞
                                    </div>
                                </div>
                            </label>
                            <div class="sale-status paid">
                                已付款
                            </div>
                        </div>
                    </div>
                    <div class="infinite-scroll-preloader">
                        <div class="preloader-label">继续拖动，查看更多</div>
                        <div class="preloader"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="js/zepto.min.js"></script>
    <script type="text/javascript" src="js/sm.min.js"></script>
    <script type="text/javascript">
    $.init();
    $(function() {
        $(document).keydown(function (event) {
            if (event.keyCode == 13) {
                event.preventDefault();
                $("#searchForm").submit();
            };
        });

        $("#all-check input[type='checkbox']").on("change", function (){
            $(".sale-list input[type='checkbox']").prop("checked", $(this).prop("checked"));
        });
        $(".sale-item input[type='checkbox']").on("change", function (){
            var flag = $(this).parents(".sale-list").find("input[type='checkbox']").length == $(this).parents(".sale-list").find("input[type='checkbox']:checked").length;
            $("#all-check input[type='checkbox']").prop("checked", flag); 
        });
        // 加载flag
        var loading = false;
        // 最多可加载的条目
        var maxItems = 100;

        // 每次加载添加多少条目
        var itemsPerLoad = 20;

        // 上次加载的序号
        var lastIndex = 20;

        // 注册'infinite'事件处理函数
        $(document).on('infinite', '.infinite-scroll', function() {

            // 如果正在加载，则退出
            if (loading) return;
            $(".preloader-label").hide();
            $(".preloader").css({
                "display": "inline-block"
            });
            // 设置flag
            loading = true;

            $.get("card-ajax.html", function(data) {
                loading = false;
                $(".preloader-label").show();
                $(".preloader").hide();
                if (lastIndex >= maxItems) {
                    // 加载完毕，则注销无限加载事件，以防不必要的加载
                    $.detachInfiniteScroll($('.infinite-scroll'));
                    // 删除加载提示符
                    $('.infinite-scroll-preloader').remove();
                    return;
                }

                // 添加新条目
                $('.infinite-scroll .sale-list').append(data);
                // 更新最后加载的序号
                lastIndex = $('.infinite-scroll .sale-item').length;
            });
        });
    });
    </script>
</body>

</html>
